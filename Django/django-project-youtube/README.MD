# django-youtube-restapi

## Docker란?

도커란 리눅스의 응용 프로그램들을 프로세스 격리 기술을 사용해 컨테이너로 실행하고 관리하는 오픈소스입니다.

VM과 달리 커널을 공유해서 사용하므로 성능향상, 이식성의 장점이 있습니다. 대신 VM 보다 보안성이 떨어집니다.

> 도커란 결국 가상머신이 아니라 프로세스를 실행하는 방법입니다. 커널 내부의 cgroup 을 사용하여 나머지 프로세스와 구분되는 프로세스입니다.

## Docker 구성요소

- Docker Daemon: Dokcer API 요청을 수신하고, 이미지, 컨테이너 등 도커 객체 관리. 다른 데몬과 통신하여 도커 서비스 관리 가능
- Docker Client: 사용자가 도커와 상호작용하는 기본 방법(Docker API). 둘 이사으이 데몬과 통신 가능
- Docker Registry: 도커 이미지를 저장, 도커 허브는 누구나 사용할 수 있는 공개형 레지스트리. docker pull/run: 레지스트리에서 이미지 가져옴, docker push: 레지스트리에 이미지 푸시
- Docker Hub: SaaS 기반의 클라우드 서비스로 도커 이미지 공유 가능
- Docker Object: 이미지 컨테이너 네트워크 볼륨 등에 관한 객체
- Docker Image: 컨테이너를 실행할 수 있는 실행파일, 설정 값 들을 가지고 있는것
- Docker Container: 이미지를 배포하여 실행한 상태, 단일 이미지를 다수 컨테이너에서 구동가능 

## Docker Image와 Docker Container

Docker Image란 컨테이너를 실행할 수 있는 실행파일입니다. 

만약 ubuntu 이미지를 만들기 위해 Layer A B C가 필요하고, 여기서 nginx 이미지를 만든다고 할 때는 ubuntu 이미지를 베이스 이미지로 사용하고 여기 위에 nginx 이미지를 더하기만 하면 됩니다. web app 이미지를 만드는 경우에도 nginx를 베이스 이미지로 두고, web app을 올려서 이미지를 만들기만 하면 됩니다.

Docker Container는 OS 레벨의 가상화로 프로세스를 격리시켜 동작하는 방식으로 이루어집니다. 다수의 컨테이너를 OS 커널에서 직접 구동합니다. 운영체제 전체 부팅보다 메모리를 훨씬 적게 차지하는 장점이 있습니다.

### Container 내부에 여러개 앱 vs 하나의 앱 ?

원칙적으로 하나의 컨테이너에 하나의 앱(프로세스) 단위로 구축하고 여러 컨테이너를 결합하는 것이 좋습니다.

컨테이너를 만드는 비용이 매우 저렴하기 때문에 복잡한 컨테이너를 하나 만드는 것보다 단순한 컨테이너를 여러 개 만드는 것이 더 효율적이고 나중에 설계를 변경하기도 쉽습니다.

> https://docs.docker.com/build/building/best-practices/#decouple-applications

> MySQL 앱을 다른 컨테이너로 만들고 네트워킹 해야하는 경우에는 동일한 네트워크에 배치를 하는 방법이 있습니다.
> https://docs.docker.com/get-started/07_multi_container/

### Container 내부에 있는 OS ?

도커의 컨테이너는 호스트 OS의 동일한 커널 위에서 돌아간다고 했는데, 막상 컨테이너에는 리눅스를 설치해서 사용하고 있습니다.

하지만 컨테이너 내부의 OS는 컨테이너 이미지가 종속된 Linux 이미지의 일종인 파일 시스템 스냅샷일 뿐입니다. 실제 OS랑은 다릅니다.

모든 컨테이너에는 최소한의 루트 파일 시스템이 있어야 하기 때문에 이런 이미지를 사용해야 하는것이죠.

---

## CI CD ?

- CI(Continuous Integration): 변경사항을 자주 통합하고 코드베이스를 지속적으로 병합하는 프로세스

- CD(Continuout Deployment): CI가 완료된 후 코드가 자동으로 배포 준비 상태에 도달하거나 실제로 배포되는 프로세스

CI의 특징

- 코드 병합 빈도 증가: 하루에도 여러 번 코드를 병합(merge)함
- 자동화된 빌드: 코드가 병합될 때마다 자동으로 빌드가 실행된다.
- 자동화된 테스트: 빌드가 완료된 후 자동화 테스트가 실행된다. 
- 버전관리시스템: git과 같은 버전 관리 시스템을 사용해 코드 병합을 관리함

CD의 특징

- 인프라 자동화: 배포 인프라가 코드로 관리되어 일관성을 유지함
- 자동화 배포: 모든 테스트를 통과한 변경 사항이 자동으로 프로덕션 환경에 배포된다.
- 무중단 배포: 배포 괒어에서 서비스의 가용성이 유지된다

### Github Actions

Github에서 제공하는 CI/CD 툴. 레포지토리 내에서 자동화된 워크플로우를 정의하고 실행할 수 있도록 지원한다.

주요기능

- 자동화된 워크플로우: 코드푸시, PR, 이슈 생성 등의 이벤트에 반응하여 작업을 실행함
- 워크플로우 파일: '.github/workflows' 디렉토리에 YAML 파일로 정의된다
- 커스텀 액션: 재사용 가능한 작업을 정의하여 다른 워크플로우에서 사용할 수 있다

구성요소

- workflow: 이벤트에 반응하여 실행되는 일련의 작업들
- job: 워크플로우 내에서 병렬 또는 순차적으로 실행되는 작업들
- step: job 내에서 실행되는 개별 명령 또는 액션
- action: 재사용 가능한 단위 작업

장점으로, Job을 여러개 만들어서 병렬로 실행하여 빌드 및 테스트 시간을 단축할 수 있습니다.

## PostgreSQL의 장점

- 오픈소스. 소스코드가 공개되어 있어 커스터마이징이 가능하다.
- SQL 표준을 준수하여 호환성이 높다

django와 궁합이 잘 맞음. 실제로 읽기, 쓰기 쿼리등의 벤치마크 성능이 좋은편. PostgreSQL의 고급기능(jsonb타입, full-text search 등)을 장고에서 쉽게 사용이 가능하다.

